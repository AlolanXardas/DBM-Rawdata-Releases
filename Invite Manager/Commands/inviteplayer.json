{
  "name": "inviteplayer",
  "permissions": "NONE",
  "restriction": "1",
  "_id": "MaaAe",
  "actions": [
    {
      "message": "0",
      "varName": "",
      "info": "0",
      "ParamN": "1",
      "separator": "",
      "storage": "1",
      "varName2": "messageParam",
      "count": "",
      "name": "Store Message Params"
    },
    {
      "behavior": "1",
      "interpretation": "1",
      "code": "    // invite player\n    var messageParam = tempVars(\"messageParam\");\n    var guildID = msg.guild.id;\n\n    var userSelected = null;\n    if (!isNaN(messageParam)) {\n        var userFetched = msg.guild.members.fetch(messageParam);\n        if (userFetched != null) {\n            userSelected = userFetched.user;\n        }\n    } else if (msg.mentions.users.first() != null) {\n        userSelected = msg.mentions.users.first();\n    } else  {\n        var fetchTest = msg.guild.members.cache.find(user => user.username == messageParam);\n        if (fetchTest != null) {\n            userSelected = fetchTest.user;\n        } else {\n            userSelected = msg.author;\n        }\n    }\n\n    async function main() {\n        if (userSelected != null) {\n            var invitePData = globalVars('invitePData');\n            var invitedData = invitePData['invitedData'];\n            var inviterData = invitePData['inviterData'];\n        \n            var invitedBy = \"None\";\n            var invited = \"None\";\n            var inviteStats = {\n                \"real\": 0,\n                \"invalid\": 0\n            };;\n        \n        \n            if (invitedData.hasOwnProperty(guildID) && invitedData[guildID].hasOwnProperty(userSelected.id) && invitedData[guildID][userSelected.id].length != 0) {\n                invitedBy = invitedData[guildID][userSelected.id];\n            }\n        \n            if (inviterData.hasOwnProperty(guildID) && inviterData[guildID].hasOwnProperty(userSelected.id)) {\n                invited = inviterData[guildID][userSelected.id][\"invites\"];\n                inviteStats = inviterData[guildID][userSelected.id][\"data\"];\n            }\n        \n        \n            if (typeof invitedBy != \"string\") {\n                \n                var invitedByUsers = [];\n        \n                if (invitedBy.length >= 3) {\n                    invitedByUsers.push(...[invitedBy[invitedBy.legnth - 1], invitedBy[invitedBy.legnth - 2], invitedBy[invitedBy.legnth - 3]]);\n                } else {\n                    invitedByUsers.push(...invitedBy);\n                }\n        \n                invitedBy = \"\";\n\n                for (i=0; i<invitedByUsers.length; i++) {\n                    var fetchedMember = await client.users.fetch(invitedByUsers[i]);\n                    var fetchedInviter = inviterData[guildID][fetchedMember.id][\"invites\"].find(inviteMem => inviteMem.id == userSelected.id);\n                    invitedBy += `${fetchedMember} | Code: ${fetchedInviter[\"codeUsed\"]}`\n                    \n                    if (!fetchedInviter[\"valid\"]) {\n                        invitedBy += ` (Invalid) (${fetchedInviter[\"invalidCause\"]})`\n                    }\n\n                    invitedBy += \"\\n\"\n                }\n            }\n\n        \n            if (typeof invited != \"string\") {\n                var invitedByUsers = [];\n        \n                if (invited.length >= 10) {\n                    for (i = 0; i < 10; i++) {\n                        invitedByUsers.push(invited[i]);\n                    }\n                } else {\n                    invited.forEach(invitedObject => {\n                        invitedByUsers.push(invitedObject);\n                    })\n                }\n        \n                invited = \"\";\n                \n                for (i=0; i<invitedByUsers.length; i++) {\n                    var fetchedMember = await client.users.fetch(invitedByUsers[i][\"id\"]);\n\n                    invited += `${fetchedMember} | Code: ${invitedByUsers[i][\"codeUsed\"]}`\n\n                    if (!invitedByUsers[i][\"valid\"]) {\n                        invited += ` (Invalid) (${invitedByUsers[i][\"invalidCause\"]})`\n                    }\n\n                    invited += \"\\n\"\n                }\n            }\n        \n            msg.channel.send({\n                embed: {\n                    color: 0x0099ff,\n                    title: `${userSelected.username}'s Invite Profile`,\n                    fields: [{\n                            name: 'Real Invites',\n                            value: `${inviteStats[\"real\"]}`,\n                            inline: true\n                        },\n                        {\n                            name: 'Invalid Invites',\n                            value: `${inviteStats[\"invalid\"]}`,\n                            inline: true\n                        },\n                        {\n                            name: 'Invited by',\n                            value: invitedBy,\n                            inline: true,\n                        },\n                        {\n                            name: 'Invited',\n                            value: invited,\n                            inline: false,\n                        }\n                    ],\n                    thumbnail: {\n                        url: userSelected.avatarURL(),\n                    },\n                    timestamp: new Date(),\n                }\n            });\n        }\n    }\n\n    main();\n\n// VersionCheck:1",
      "storage": "0",
      "varName": "",
      "name": "Run Script"
    }
  ]
}